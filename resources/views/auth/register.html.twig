{% extends 'layouts/auth.twig' %}

{% block title %}Inscription{% endblock %}

{% block content %}
    <div class="text-center mb-8">
        <h1 class="text-2xl font-heading font-bold text-slate-900 mb-2">Rejoignez-nous !</h1>
        <p class="text-slate-600">Créez votre compte créatrice en quelques secondes</p>
    </div>

    <form action="/register" method="POST" class="space-y-5">
        <input type="hidden" name="csrf_token" value="{{ csrf_token }}">

        <div>
            <label for="name" class="block text-sm font-medium text-slate-700 mb-1">Nom complet</label>
            <div class="relative">
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                    <i class="fas fa-user text-slate-400"></i>
                </div>
                <input
                    type="text"
                    id="name"
                    name="name"
                    required
                    minlength="2"
                    maxlength="50"
                    autocomplete="name"
                    value="{{ old.name|default('') }}"
                    class="block w-full pl-10 pr-3 py-2.5 border border-slate-300 rounded-lg text-slate-900 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all"
                    placeholder="Votre nom"
                >
            </div>
        </div>

        <div>
            <label for="email" class="block text-sm font-medium text-slate-700 mb-1">Adresse Email</label>
            <div class="relative">
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                    <i class="fas fa-envelope text-slate-400"></i>
                </div>
                <input
                    type="email"
                    id="email"
                    name="email"
                    required
                    autocomplete="email"
                    value="{{ old.email|default('') }}"
                    class="block w-full pl-10 pr-3 py-2.5 border border-slate-300 rounded-lg text-slate-900 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all"
                    placeholder="vous@exemple.com"
                >
            </div>
        </div>

        <div>
            <label for="password" class="block text-sm font-medium text-slate-700 mb-1">Mot de passe</label>
            <div class="relative">
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                    <i class="fas fa-lock text-slate-400"></i>
                </div>
                <input
                    type="password"
                    id="password"
                    name="password"
                    required
                    minlength="8"
                    autocomplete="new-password"
                    class="block w-full pl-10 pr-10 py-2.5 border border-slate-300 rounded-lg text-slate-900 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all"
                    placeholder="Minimum 8 caractères"
                >
                <button type="button" class="absolute inset-y-0 right-0 pr-3 flex items-center text-slate-400 hover:text-slate-600 focus:outline-none toggle-password">
                    <i class="fas fa-eye"></i>
                </button>
            </div>
            {# Simple password strength indicator #}
            <div class="mt-2 h-1 w-full bg-slate-100 rounded-full overflow-hidden hidden" id="strength-container">
                <div class="h-full bg-red-500 transition-all duration-300 w-0" id="strength-bar"></div>
            </div>
            <p class="mt-1 text-xs text-slate-500 hidden" id="strength-text"></p>
        </div>

        <div>
            <label for="password_confirm" class="block text-sm font-medium text-slate-700 mb-1">Confirmer le mot de passe</label>
            <div class="relative">
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                    <i class="fas fa-lock text-slate-400"></i>
                </div>
                <input
                    type="password"
                    id="password_confirm"
                    name="password_confirm"
                    required
                    minlength="8"
                    autocomplete="new-password"
                    class="block w-full pl-10 pr-10 py-2.5 border border-slate-300 rounded-lg text-slate-900 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all"
                    placeholder="Retapez votre mot de passe"
                >
            </div>
        </div>

        <div class="flex items-start">
            <div class="flex items-center h-5">
                <input
                    id="terms"
                    name="terms"
                    type="checkbox"
                    required
                    class="h-4 w-4 text-primary-600 focus:ring-primary-500 border-slate-300 rounded cursor-pointer"
                >
            </div>
            <div class="ml-3 text-sm">
                <label for="terms" class="font-medium text-slate-700">J'accepte les conditions</label>
                <p class="text-slate-500">En vous inscrivant, vous acceptez nos <a href="/terms" class="text-primary-600 hover:text-primary-700 underline">conditions d'utilisation</a> et notre <a href="/privacy" class="text-primary-600 hover:text-primary-700 underline">politique de confidentialité</a>.</p>
            </div>
        </div>

        <button type="submit" class="w-full flex justify-center items-center gap-2 py-2.5 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-all transform hover:-translate-y-0.5">
            <i class="fas fa-user-plus"></i>
            <span>Créer mon compte</span>
        </button>
    </form>

    <div class="mt-8 text-center text-sm">
        <span class="text-slate-500">Déjà un compte ?</span>
        <a href="/login" class="font-medium text-primary-600 hover:text-primary-700 ml-1">
            Se connecter
        </a>
    </div>

    <script>
        // Toggle Password Visibility
        document.querySelectorAll('.toggle-password').forEach(button => {
            button.addEventListener('click', function() {
                const input = this.parentElement.querySelector('input');
                const icon = this.querySelector('i');
                if (input.type === 'password') {
                    input.type = 'text';
                    icon.classList.remove('fa-eye');
                    icon.classList.add('fa-eye-slash');
                } else {
                    input.type = 'password';
                    icon.classList.remove('fa-eye-slash');
                    icon.classList.add('fa-eye');
                }
            });
        });

        // Simple Password Strength
        const passwordInput = document.getElementById('password');
        const strengthBar = document.getElementById('strength-bar');
        const strengthContainer = document.getElementById('strength-container');
        const strengthText = document.getElementById('strength-text');

        if(passwordInput) {
            passwordInput.addEventListener('input', function() {
                const val = this.value;
                if(val.length > 0) {
                    strengthContainer.classList.remove('hidden');
                    strengthText.classList.remove('hidden');
                } else {
                    strengthContainer.classList.add('hidden');
                    strengthText.classList.add('hidden');
                    return;
                }

                let strength = 0;
                if(val.length >= 8) strength += 1;
                if(val.match(/[a-z]/) && val.match(/[A-Z]/)) strength += 1;
                if(val.match(/\d/)) strength += 1;
                if(val.match(/[^a-zA-Z\d]/)) strength += 1;

                let width = '0%';
                let color = 'bg-red-500';
                let text = 'Faible';

                switch(strength) {
                    case 0: break; 
                    case 1: width = '25%'; color = 'bg-red-500'; text = 'Très faible'; break;
                    case 2: width = '50%'; color = 'bg-orange-500'; text = 'Faible'; break;
                    case 3: width = '75%'; color = 'bg-yellow-500'; text = 'Moyen'; break;
                    case 4: width = '100%'; color = 'bg-green-500'; text = 'Fort'; break;
                }

                strengthBar.style.width = width;
                strengthBar.className = `h-full transition-all duration-300 ${color}`;
                strengthText.textContent = text;
            });
        }
    </script>
{% endblock %}
